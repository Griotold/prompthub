# í”„ë¡¬í”„íŠ¸í—ˆë¸Œ(PromptHub) ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

## ğŸ“Š ERD ê°œìš”
```
users (ì‚¬ìš©ì) 
  â†“ 1:N
prompts (í”„ë¡¬í”„íŠ¸)
  â†“ N:1
categories (ì¹´í…Œê³ ë¦¬)

users â†â†’ prompts (N:M) via prompt_likes (ì¢‹ì•„ìš”)
users â†â†’ prompts (N:M) via prompt_bookmarks (ë¶ë§ˆí¬)
prompts â†â†’ tags (N:M) via prompt_tags (íƒœê·¸)
```

## ğŸ—ƒï¸ í…Œì´ë¸” ìƒì„¸ ì„¤ê³„

### 1. ì¹´í…Œê³ ë¦¬
```
create table p_category
(
    id          bigint generated by default as identity
        primary key,
    createdat   timestamp(6),
    description text,
    isactive    boolean     not null,
    name        varchar(50) not null
        constraint uknu7gee55si4emj6suq55er2wv
            unique,
    updatedat   timestamp(6)
);

alter table p_category
    owner to spring;
```

### 2. íšŒì›
```
CREATE TABLE p_member (
    email_verified BOOLEAN NOT NULL,
    deactivated_at TIMESTAMP(6),
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    registered_at TIMESTAMP(6),
    updated_at TIMESTAMP(6),
    provider VARCHAR(20)
        CONSTRAINT p_member_provider_check
            CHECK ((provider)::text = ANY
                   ((ARRAY ['GOOGLE'::character varying, 'NAVER'::character varying, 'KAKAO'::character varying])::text[])),
    role VARCHAR(50) NOT NULL
        CONSTRAINT p_member_role_check
            CHECK ((role)::text = ANY ((ARRAY ['USER'::character varying, 'ADMIN'::character varying])::text[])),
    status VARCHAR(50) NOT NULL
        CONSTRAINT p_member_status_check
            CHECK ((status)::text = ANY
                   ((ARRAY ['ACTIVE'::character varying, 'DEACTIVATED'::character varying])::text[])),
    nickname VARCHAR(100) NOT NULL,
    provider_id VARCHAR(100),
    email_address VARCHAR(150) NOT NULL,
    password_hash VARCHAR(200),
    profile_image_url VARCHAR(500),  -- í”„ë¡œí•„ ì´ë¯¸ì§€ URL
    introduction TEXT,                        -- ìê¸°ì†Œê°œ
    CONSTRAINT uk_email_provider UNIQUE (email_address, provider)
);

alter table p_member
    owner to spring;
```

### 3. í”„ë¡¬í”„íŠ¸
```
create table p_prompt
(
    id             bigint generated by default as identity
        primary key,
    content        text         not null,
    createdat      timestamp(6),
    description    text,
    ispublic       boolean      not null,
    likescount     integer      not null default 0,
    title          varchar(200) not null,
    updatedat      timestamp(6),
    viewscount     integer      not null default 0,
    average_rating decimal(3,2) default 0.0,
    reviews_count  integer      default 0,
    category_id    bigint
        constraint fka16juxw5kxakt90ws8ogb4w7l
            references p_category,
    member_id      bigint
        constraint fkv8rkui4wse6rh8t01qw3po42
            references p_member(id)
);

alter table p_prompt
    owner to spring;
```

### 4. í”„ë¡¬í”„íŠ¸ - ì¢‹ì•„ìš”
```
create table p_prompt_like
(
    id        bigint generated by default as identity
        primary key,
    createdat timestamp(6),
    member_id bigint
        constraint fk1uco9nk6vnd75otk7nwsb6flq
            references p_member(id),
    prompt_id bigint
        constraint fkptt5htv66nclb079dxlaohv1l
            references p_prompt(id),
    constraint uk3w6tqtrb6nu5bfocj0pwrpl9b
        unique (member_id, prompt_id)
);

alter table p_prompt_like
    owner to spring;
```

### 5. íƒœê·¸
```
-- íƒœê·¸ í…Œì´ë¸”
create table p_tag
(
    id        bigint generated by default as identity primary key,
    name      varchar(50) not null unique,
    createdat timestamp(6),
    isactive  boolean not null default true
);
```

### 6. í”„ë¡¬í”„íŠ¸ - íƒœê·¸ ì—°ê²° í…Œì´ë¸”
```
-- í”„ë¡¬í”„íŠ¸-íƒœê·¸ ì—°ê²° í…Œì´ë¸” (Many-to-Many)
create table p_prompt_tag
(
    id        bigint generated by default as identity primary key,
    prompt_id bigint not null references p_prompt(id),
    tag_id    bigint not null references p_tag(id),
    createdat timestamp(6),
    constraint uk_prompt_tag unique (prompt_id, tag_id)
);
```

### 7. ë¦¬ë·°/í‰ì  í…Œì´ë¸”
```
-- ë¦¬ë·° í…Œì´ë¸” (í‰ì  + í…ìŠ¤íŠ¸ ë¦¬ë·° í†µí•©)
create table p_review
(
    id        bigint generated by default as identity primary key,
    prompt_id bigint not null references p_prompt(id),
    member_id bigint not null references p_member(id),
    rating    integer not null check (rating >= 1 and rating <= 5),
    content   text, -- í…ìŠ¤íŠ¸ ë¦¬ë·° (ì„ íƒì‚¬í•­)
    createdat timestamp(6),
    updatedat timestamp(6),
    constraint uk_member_prompt_review unique (member_id, prompt_id)
);
```

### 8. ë¬¸ì˜ í…Œì´ë¸”
```
CREATE TABLE p_inquiry (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    member_id BIGINT REFERENCES p_member(id),
    category VARCHAR(50) NOT NULL, -- 'ê¸°ìˆ ì§€ì›', 'ê³„ì •ë¬¸ì˜', 'ê¸°íƒ€'
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    contact_email VARCHAR(150), -- ë¹„íšŒì›ë„ ë¬¸ì˜ ê°€ëŠ¥
    contact_name VARCHAR(100),   -- ë¹„íšŒì› ì´ë¦„
    status VARCHAR(20) DEFAULT 'PENDING', -- 'PENDING', 'IN_PROGRESS', 'RESOLVED'
    admin_reply TEXT,
    created_at TIMESTAMP(6),
    updated_at TIMESTAMP(6),
    resolved_at TIMESTAMP(6)
);
```